<!-- src/app/pages/dashboard/dashboard.component.html -->
<div class="dashboard">
  <div class="kpi-row">
    <app-kpi-card
      *ngFor="let card of kpiCards"
      [label]="card.label"
      [value]="card.value"
      [sublabel]="card.sublabel"
      [variant]="card.variant"
      [icon]="card.icon">
    </app-kpi-card>
  </div>

  <div class="grid">
    <mat-card class="recent">
      <mat-card-title>
        {{ 'dashboard.recent.title' | translate }}
      </mat-card-title>
      <mat-card-subtitle>
        {{ 'dashboard.recent.subtitle' | translate }}
      </mat-card-subtitle>

      <mat-tab-group [(selectedIndex)]="tabIndex">
        <mat-tab label="{{ 'dashboard.tabs.open' | translate }}">
          <ng-container *ngFor="let v of recentOpen">
            <div class="visit mt-2">
              <div class="info">
                <h4>{{ v.name }}</h4>
                <p>{{ v.company }}</p>
                <p class="meta">
                  {{ v.department }} •
                  {{ 'dashboard.host' | translate }}: {{ v.host }} •
                  {{ v.time }}
                </p>
              </div>
              <span class="chip chip-warning">
                {{ 'dashboard.chip.in_building' | translate }}
              </span>
            </div>
          </ng-container>
        </mat-tab>

        <mat-tab label="{{ 'dashboard.tabs.closed' | translate }}">
          <ng-container *ngFor="let v of recentClosed">
            <div class="visit mt-2">
              <div class="info">
                <h4>{{ v.name }}</h4>
                <p>{{ v.company }}</p>
                <p class="meta">
                  {{ v.department }} •
                  {{ 'dashboard.host' | translate }}: {{ v.host }} •
                  {{ v.time }}
                </p>
              </div>
              <span class="chip chip-green">
                {{ 'dashboard.chip.done' | translate }}
              </span>
            </div>
          </ng-container>
        </mat-tab>
      </mat-tab-group>
    </mat-card>

    <mat-card class="departments">
      <mat-card-title>
        {{ 'dashboard.departments.title' | translate }}
      </mat-card-title>
      <mat-card-subtitle>
        {{ 'dashboard.departments.subtitle' | translate }}
      </mat-card-subtitle>

      <div class="dept" *ngFor="let d of departments">
        <div class="label">
          {{ d.name }}
          <span>{{ d.value }}</span>
        </div>
        <div class="bar">
          <div class="bar-fill" [style.width.%]="d.percent"></div>
        </div>
      </div>
    </mat-card>
  </div>
</div>
